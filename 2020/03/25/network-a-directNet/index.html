<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>network-a-directNet.md | Alex</title><meta name="description" content="network-a-directNet.md"><meta name="keywords" content="network"><meta name="author" content="Alex"><meta name="copyright" content="Alex"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="network-a-directNet.md"><meta name="twitter:description" content="network-a-directNet.md"><meta name="twitter:image" content="https://herycs.github.io/img/post.jpg"><meta property="og:type" content="article"><meta property="og:title" content="network-a-directNet.md"><meta property="og:url" content="https://herycs.github.io/2020/03/25/network-a-directNet/"><meta property="og:site_name" content="Alex"><meta property="og:description" content="network-a-directNet.md"><meta property="og:image" content="https://herycs.github.io/img/post.jpg"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = 'false'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://herycs.github.io/2020/03/25/network-a-directNet/"><link rel="prev" title="network-a-interconnection.md" href="https://herycs.github.io/2020/05/20/network-a-interconnection/"><link rel="next" title="network-a-communication.md" href="https://herycs.github.io/2020/03/15/network-a-communication/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">26</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">17</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">8</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/documents"><i class="fa-fw fa fa-music"></i><span> Documents</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#network-链路层"><span class="toc-number">1.</span> <span class="toc-text">network-链路层</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#链路层概述"><span class="toc-number">1.1.</span> <span class="toc-text">链路层概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#适配器"><span class="toc-number">1.1.1.</span> <span class="toc-text">适配器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#链路层服务设计"><span class="toc-number">1.1.2.</span> <span class="toc-text">链路层服务设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#协议-规程分类"><span class="toc-number">1.1.3.</span> <span class="toc-text">协议&#x2F;规程分类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#服务实现"><span class="toc-number">1.2.</span> <span class="toc-text">服务实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#成帧"><span class="toc-number">1.3.</span> <span class="toc-text">成帧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#概述"><span class="toc-number">1.3.1.</span> <span class="toc-text">概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#面向字节的协议"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">面向字节的协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#面向比特的协议"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">面向比特的协议</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#差错检测和纠正技术"><span class="toc-number">1.3.2.</span> <span class="toc-text">差错检测和纠正技术</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#差错检测"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">差错检测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#纠正技术"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">纠正技术</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#可靠传输"><span class="toc-number">1.3.3.</span> <span class="toc-text">可靠传输</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#问题引入"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">问题引入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#设计可靠数据传输协议"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">设计可靠数据传输协议</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#总结"><span class="toc-number">1.3.4.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#流水线"><span class="toc-number">1.4.</span> <span class="toc-text">流水线</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#协议"><span class="toc-number">1.4.1.</span> <span class="toc-text">协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#概念"><span class="toc-number">1.4.2.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#问题及处理策略"><span class="toc-number">1.4.3.</span> <span class="toc-text">问题及处理策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#具体实现"><span class="toc-number">1.4.4.</span> <span class="toc-text">具体实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#协议-1"><span class="toc-number">1.5.</span> <span class="toc-text">协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PPP协议"><span class="toc-number">1.5.1.</span> <span class="toc-text">PPP协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#基础"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">基础</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#工作流程"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">工作流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#协议帧格式"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">协议帧格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#认证"><span class="toc-number">1.5.1.4.</span> <span class="toc-text">认证</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#有线LAN技术"><span class="toc-number">1.6.</span> <span class="toc-text">有线LAN技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#多路访问链路和协议"><span class="toc-number">1.6.1.</span> <span class="toc-text">多路访问链路和协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用场景"><span class="toc-number">1.6.2.</span> <span class="toc-text">应用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#协议要求"><span class="toc-number">1.6.3.</span> <span class="toc-text">协议要求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实现"><span class="toc-number">1.6.4.</span> <span class="toc-text">实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#策略"><span class="toc-number">1.6.5.</span> <span class="toc-text">策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#效率"><span class="toc-number">1.6.6.</span> <span class="toc-text">效率</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#以太网"><span class="toc-number">1.7.</span> <span class="toc-text">以太网</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MAC地址"><span class="toc-number">1.7.1.</span> <span class="toc-text">MAC地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MAC结构"><span class="toc-number">1.7.2.</span> <span class="toc-text">MAC结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#不可靠，无连接的服务"><span class="toc-number">1.7.3.</span> <span class="toc-text">不可靠，无连接的服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#无效MAC帧"><span class="toc-number">1.7.4.</span> <span class="toc-text">无效MAC帧</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#物理"><span class="toc-number">1.8.</span> <span class="toc-text">物理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#集线器"><span class="toc-number">1.8.1.</span> <span class="toc-text">集线器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#交换机"><span class="toc-number">1.8.2.</span> <span class="toc-text">交换机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网桥，以太网交换机"><span class="toc-number">1.8.3.</span> <span class="toc-text">网桥，以太网交换机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#交换机工作方式"><span class="toc-number">1.8.4.</span> <span class="toc-text">交换机工作方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#帧转发过程"><span class="toc-number">1.8.5.</span> <span class="toc-text">帧转发过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据交换"><span class="toc-number">1.8.6.</span> <span class="toc-text">数据交换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#链路层交换机特点"><span class="toc-number">1.8.7.</span> <span class="toc-text">链路层交换机特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#问题"><span class="toc-number">1.8.8.</span> <span class="toc-text">问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#虚拟局域网"><span class="toc-number">1.9.</span> <span class="toc-text">虚拟局域网</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#以太帧格式"><span class="toc-number">1.9.1.</span> <span class="toc-text">以太帧格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#构建技术"><span class="toc-number">1.9.2.</span> <span class="toc-text">构建技术</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/post.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Alex</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/documents"><i class="fa-fw fa fa-music"></i><span> Documents</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">network-a-directNet.md</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="Created 2020-03-25 19:39:20"><i class="fa fa-calendar" aria-hidden="true"></i> Created 2020-03-25</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="Updated 2020-03-25 19:39:20"><i class="fa fa-history" aria-hidden="true"></i> Updated 2020-03-25</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/network/">network</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>Post View:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h1 id="network-链路层"><a href="#network-链路层" class="headerlink" title="network-链路层"></a>network-链路层</h1><blockquote>
<p>校验和: 一个传输分组中比特错误</p>
<p>定时器: 检测超时重传分组</p>
<p>序号: 将发送方向接受方的数据分组按顺序编号</p>
<p>确认: 告诉发送方一个分组或一组分组接受完成</p>
<p>否认确认: 告诉发送方一个分组或一组分组接受<strong>未正确接收</strong></p>
<p>窗口，流水线: 发送方的利用率可在一定操作模式下得到提高，窗口长度可依据双方接受能力，网络拥塞程度调整</p>
<p>多路访问协议: 多个发送/接收结点同时使用广播信道，协调它们共享一个信道的方式。</p>
</blockquote>
<h2 id="链路层概述"><a href="#链路层概述" class="headerlink" title="链路层概述"></a>链路层概述</h2><p><strong>链路层协议内容</strong></p>
<ul>
<li>通过单段链路，点到点传送上层数据</li>
<li>链路两端结点间交互的帧格式，发送和接收帧时的操作</li>
</ul>
<p><strong>两种网络链路类型</strong></p>
<ul>
<li>点对点链路</li>
<li>广播链路</li>
</ul>
<p><strong>链路层环境重要特点</strong></p>
<ul>
<li>一条路径上的不同链路可运行不同的链路层协议</li>
<li>链路层协议提供的服务可能不同</li>
<li>通信环境较为简单</li>
</ul>
<p><strong>数据链路层功能在哪里实现？</strong></p>
<p>网络适配器硬件：核心功能<br>驱动程序：链路层的SAP，与网络层的接口</p>
<p><strong>网络适配器及其协议栈的功能关系</strong></p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5CANGLE0%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200509201059887.png"  alt="image-20200509201059887"></p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5CANGLE0%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200509203220212.png"  alt="image-20200509203220212"></p>
<h3 id="适配器"><a href="#适配器" class="headerlink" title="适配器"></a>适配器</h3><p><strong>作用</strong></p>
<p>网络接口板又称为通信适配器(adapter)或网络接口卡NIC (Network Interface Card)，简称“网卡”。</p>
<p>网卡与局域网之间的通信是通过<strong>电缆</strong>以串行方式进行的，而和计算机之间的通信是通过计算机主板上的<strong>I/O总线</strong>以<strong>并行</strong>传输方式进行的。 </p>
<p><strong>重要功能</strong></p>
<ul>
<li>成帧</li>
<li>差错检测</li>
<li>链路接入</li>
<li>流量控制</li>
<li>媒体接入</li>
</ul>
<h3 id="链路层服务设计"><a href="#链路层服务设计" class="headerlink" title="链路层服务设计"></a>链路层服务设计</h3><p><strong>成帧</strong></p>
<p>如何将数据报封装成帧：帧的附加信息、帧定界方法</p>
<p><strong>差错检测</strong></p>
<p>检错的方法：奇偶校验、检验和、CRC<br>检错的实现：网卡上硬件设计<br>差错的定义：误比特率</p>
<p><strong>可靠交付</strong></p>
<p>无差错、不丢失、按序、不重复<br>机制：FEC、ARQ</p>
<p><strong>流量控制</strong></p>
<p>相邻发送和接收结点间的步调一致，流量不匹配将导致数据丢失</p>
<p> <strong>媒体访问</strong></p>
<ul>
<li>冲突的仲裁和解决</li>
<li>点到点链路：全双工（物理、逻辑链路设计）、半双工</li>
<li>广播共享链路：静态复用、动态媒体访问控制</li>
</ul>
<h3 id="协议-规程分类"><a href="#协议-规程分类" class="headerlink" title="协议/规程分类"></a>协议/规程分类</h3><p><img src="/" class="lazyload" data-src="C:%5CUsers%5CANGLE0%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200509205405880.png"  alt="image-20200509205405880"></p>
<h2 id="服务实现"><a href="#服务实现" class="headerlink" title="服务实现"></a>服务实现</h2><h2 id="成帧"><a href="#成帧" class="headerlink" title="成帧"></a>成帧</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p><strong>原因</strong>：非全局同步系统，需要从比特流中将传输的数据分离出来。</p>
<p><strong>方式</strong>：通过在要传输的数据前面或后面添加特殊标记来实现数据的同步</p>
<p>常用方法：首尾定界符，前导同步序列。</p>
<p><strong>传输数据大小</strong></p>
<p>帧长越长信道利用率越高，但是出错的概率也越大。于是，每种链路层协议规定了所允许的最大传输单元MTU（帧的数据部分长度上限）</p>
<h4 id="面向字节的协议"><a href="#面向字节的协议" class="headerlink" title="面向字节的协议"></a>面向字节的协议</h4><ul>
<li>每帧都看成是字节的集合</li>
<li>保留一组字符为控制字符</li>
<li>效率较低，目前已<strong>很少使用</strong></li>
<li>DLE字符的“转义”作用</li>
</ul>
<p><strong>透明传输问题</strong></p>
<p>数据中有可能出现与帧定界相同的符号或序列，引起数据丢失。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">传输的帧: [SOH        EOF           EOF]</span><br><span class="line">实质帧的数据为：SOH到第二个EOF，但由于识别时以EOF为结束符，故识别出来的数据其实少了后面[EOF,EOF]的数据</span><br></pre></td></tr></table></figure>

<p><strong>解决办法</strong>：面向字符协议：字节填充技术</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//还是上面的例子：</span><br><span class="line">传输的帧:      [SOH        EOF           EOF]</span><br><span class="line">填充后的帧: [SOH       ESCEOF           EOF]</span><br></pre></td></tr></table></figure>

<h4 id="面向比特的协议"><a href="#面向比特的协议" class="headerlink" title="面向比特的协议"></a>面向比特的协议</h4><ul>
<li>面向比特的协议把帧看成比特的集合</li>
</ul>
<p><strong>实现</strong>：透明传输：比特填充 (bit stuffing)法(用于发送前/接收后)</p>
<ul>
<li>发送方：报文中5个连续1，插入0</li>
<li>接收方：收到5个连续1：后为0 ，去掉；为1，后为0，则帧结束；否则出错</li>
</ul>
<h3 id="差错检测和纠正技术"><a href="#差错检测和纠正技术" class="headerlink" title="差错检测和纠正技术"></a>差错检测和纠正技术</h3><h4 id="差错检测"><a href="#差错检测" class="headerlink" title="差错检测"></a><strong>差错检测</strong></h4><p>EDC= 差错检测和纠错比特 (冗余)</p>
<p>D    = 数据由差错校验保护，可能包括首部字段</p>
<p>差错检测不是100%可靠!</p>
<ul>
<li>协议可能漏掉某些差错，但是非常少</li>
<li>较大的EDC字段产生更好的检测和纠正</li>
</ul>
<p><strong>奇偶校验</strong></p>
<p>校验依据：判断传输的一组二进制数据中”1”的个数是奇数还是偶数</p>
<p>奇校验：如果以二进制数据中1的个数是奇数为依据，则是奇校验</p>
<p>偶校验：如果以二进制数据中1的个数是偶数为依据，则是偶校验</p>
<p><strong>检验和方法</strong></p>
<p>发送数据时步骤</p>
<ol>
<li>把校验和字段设置为0；</li>
<li>把需要校验的数据看成以16位为单位的数字组成，依次进行二进制反码求和；</li>
<li>把得到的结果存入校验和字段中。（校验字段是反码的和）</li>
</ol>
<p>接收数据时步骤</p>
<ol>
<li>把首部看成以16位为单位的数字组成，依次进行二进制反码求和，包括校验和字段；</li>
<li>检查计算出的校验和的反码是否为0；（反码和加和的反码）</li>
<li>如果等于0，说明被整除，校验和正确。否则，校验和就是错误的，协议栈要抛弃这个数据包。</li>
</ol>
<p>与传统二进制不同</p>
<ol>
<li>都是无符号整数</li>
<li>是求和不是异或，所以有进位</li>
<li>最高位的进位回卷到最低位</li>
<li>所以1111有可能是溢出，因此先取反后求和与先求和后取反，得到的结果是一样的</li>
</ol>
<blockquote>
<p><a href="https://blog.csdn.net/samaritan_infi/article/details/78884268" target="_blank" rel="noopener">为什么用先反码后求和</a></p>
</blockquote>
<p><strong>循环冗余检测(CRC)</strong></p>
<p><strong>策略</strong></p>
<ul>
<li><p>加检查位：在信息报文上加上一些检查位，构成一个特定的待传报文，使它能被一个事先约定的多项式（生成多项式）除尽。</p>
</li>
<li><p>多项式校验：接收方收到报文后，再用同样的生成多项式去除收到的报文多项式，可以除尽表示传输无误，否则不正确。 </p>
</li>
</ul>
<p><strong>注意点</strong></p>
<p>循环冗余校验码除法计算过程中采用模2运算，即在运算过程中不存在进位、借位问题，数据只有0、1两个状态；</p>
<p>计算过程中的所有减法和加法都遵循异或规则；</p>
<p>够不够减的判定原则是数据位长是否相等，而非值的大小。</p>
<blockquote>
<p>广泛应用于通信网络的链路层协议中，以硬件实现</p>
</blockquote>
<p>CRC校验可以100％地检测出长度小于等于k（k为G（x）的阶数）的突发错误。所以CRC的生成多项式的阶数越高，那么误判的概率就越小。 </p>
<h4 id="纠正技术"><a href="#纠正技术" class="headerlink" title="纠正技术"></a>纠正技术</h4><table>
<thead>
<tr>
<th>技术</th>
<th>策略</th>
<th>效果</th>
<th>适用场合</th>
</tr>
</thead>
<tbody><tr>
<td>检错重发(detect and retransmission)</td>
<td>检测到发送方报文受损，则通知发送方重传副本</td>
<td>差错率低效果好</td>
<td>合链路差错率很低的场合，如有线通信</td>
</tr>
<tr>
<td>前向纠错(Forward Error Correction, FEC)</td>
<td>纠错通过额外信息“预先”进行</td>
<td>时效性</td>
<td>适合对时间要求很高的场合，如航天和实时控制</td>
</tr>
</tbody></table>
<h3 id="可靠传输"><a href="#可靠传输" class="headerlink" title="可靠传输"></a>可靠传输</h3><h4 id="问题引入"><a href="#问题引入" class="headerlink" title="问题引入"></a>问题引入</h4><ul>
<li><p>理想信道的数据传输模型：信道可靠+缓存无限大</p>
</li>
<li><p>实际信道不能保证处理机速度匹配，又不能保证不出错！</p>
</li>
</ul>
<p>解决办法：引入确认采用反馈机制调节发送速度</p>
<h4 id="设计可靠数据传输协议"><a href="#设计可靠数据传输协议" class="headerlink" title="设计可靠数据传输协议"></a>设计可靠数据传输协议</h4><p><strong>SW0协议</strong></p>
<blockquote>
<p>信道不丢包但会出错的情况下：</p>
</blockquote>
<p><strong>解决方案</strong></p>
<ul>
<li>接到正确PKT，发送一个肯定确认(ACK)</li>
<li>收到错误PKT，发送一个否定确认(NAK)，重传原PKT</li>
<li>停止等待协议(stop-and-wait, SW)</li>
</ul>
<blockquote>
<p>实用中有不少漏洞</p>
</blockquote>
<p><strong>SW1协议</strong></p>
<p><strong>问题</strong></p>
<p>有丢包引起协议死锁</p>
<p><strong>解决方案</strong></p>
<ul>
<li>增加超时定时器</li>
<li>每发PKT，启动超时定时器，称为超时重传机制</li>
<li>重传时间略大于RTT</li>
</ul>
<p><strong>问题</strong></p>
<p>确认分组丢失，出现了分组冗余</p>
<p><strong>解决方案</strong></p>
<ul>
<li>增加一种新机制：发送序号<ul>
<li>要求：序号空间要较小，如：发送序号3 bit，在0~7间循环使用 </li>
</ul>
</li>
</ul>
<p><strong>SW3协议</strong></p>
<p><strong>问题</strong></p>
<p>发送方过早超收到重复的确认，无法分辨对应哪个分组</p>
<p><strong>解决方案</strong></p>
<ul>
<li>增加确认序号机制，分辨出确认对应哪个分组</li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><strong>综合以上机制为SW协议，或自动重传请求(ARQ)</strong></p>
<p>使用上述的确认和重传机制，我们就可以在<strong>不可靠的信道</strong>或链路上实现<strong>可靠的数据通信</strong>。<br>这种可靠传输协议常称为自动重传请求ARQ (Automatic Repeat reQuest)。<br>ARQ 表明重传的请求是自动进行的。接收方不需要请求发送方重传某个出错的分组 </p>
<p>分析ARQ协议的效率<br>协议效率=    工作时间内协议实际发送的数据量<br>                     工作时间内网络理论可以传输的数据量<br>ARQ协议效率=1/（1+2ɑ），其中ɑ=Tp/Tf&gt;=1</p>
<h2 id="流水线"><a href="#流水线" class="headerlink" title="流水线"></a>流水线</h2><blockquote>
<p>流水线: 发送方允许发送多个、传输中、未应答的分组</p>
<ul>
<li>必须增加序号范围</li>
<li>发送方和/或接收方设有缓冲</li>
</ul>
</blockquote>
<h3 id="协议"><a href="#协议" class="headerlink" title="协议"></a>协议</h3><ul>
<li>回退N步（go-Back-N）,</li>
<li>选择性重传（S-R） </li>
</ul>
<h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p><strong>发送窗口</strong>：用来对发送端进行流量控制，而发送窗口的大小WT就代表在还没有收到对方确认信息的情况下发送端最多可以连续发送数据个数。</p>
<p><strong>接收窗口</strong>：其大小WR代表可以连续接收的最多数据个数，窗内是当前欲接收的数据的发送序号（只有序号在窗口内的数据才可以接收，否则丢弃）。<br>接收窗口驱动发送窗口的转动</p>
<h3 id="问题及处理策略"><a href="#问题及处理策略" class="headerlink" title="问题及处理策略"></a>问题及处理策略</h3><p><strong>问题</strong>：滑动窗口序号不可无限增大</p>
<p><strong>处理</strong>：滑动窗口的序号将随数据一起传送，显然不能无限制增大，当用k个比特对数据编号时，序号范围将在0～2k-1之间循环；</p>
<p><strong>问题</strong>：序号与窗口的关系？</p>
<p><strong>应对</strong></p>
<p>协议是1分组1确认，即Wt =Wr=1，所以只要与前1分组序号能够区分即可，因此仅需1bit序号；<br>GNB协议为了保证仅按序接收显然Wr=1，那么Wt =？</p>
<p>同理对于SR，接收窗口必须最多和发送窗口一样大，且Wr ≤2k-1</p>
<p>对于滑动窗口协议，一般发送窗口大小+接收窗口大小=2k</p>
<h3 id="具体实现"><a href="#具体实现" class="headerlink" title="具体实现"></a>具体实现</h3><p><strong>滑动窗口</strong></p>
<ul>
<li>在分组首部需要K比特序号，2k=N</li>
<li>“窗口”最大为N-1, 允许N个连续的没有应答分组</li>
</ul>
<p>ACK(n): 确认序号<strong>n-1</strong>之前所有的分组，期待n号帧 - “累计ACK”</p>
<p><strong>问题</strong>：可能收到重复的ACK</p>
<p>应对：对每个传输中的分组用同一个计时器timeout(n): 若超时，重传窗口中的分组n及所有更高序号的分组</p>
<p><strong>回退N步协议(Go-Back-N)</strong></p>
<p><strong>概念</strong></p>
<ul>
<li>接收方根据滑动窗口的序号按序接收分组</li>
<li>窗口中失序分组及后面将被丢弃</li>
<li>发送方采用<strong>超时</strong>机制来<strong>重传</strong>出现丢失或差错的分组及其以后未被确认的分组</li>
<li>接收方采用<strong>累积确认</strong>的方式</li>
<li>GBN协议的接收窗口的长度为1</li>
</ul>
<p><strong>特点</strong></p>
<ul>
<li><p>在分组首部需要K比特序号，N=2k-1</p>
</li>
<li><p>“窗口”最大为N</p>
</li>
</ul>
<p><strong>问题及处理策略</strong></p>
<p><strong>问题</strong>：效率问题</p>
<p>在按序接收问题上面处理过于简单，将导致大量正确数据的重复传送并被丢弃。影响协议效率，极端情况下效率可能低于停-等ARQ</p>
<p>应对：<strong>选择重传</strong>——SR协议</p>
<p>想要提高效率，可以扩大 接收窗口，先缓存失序但正确到达的分组，让发送方仅重传丢失或出错的分组，等到“落后”的分组到达接收方后再一起提交</p>
<p>选择性重传: 发送方/接收方窗口</p>
<h2 id="协议-1"><a href="#协议-1" class="headerlink" title="协议"></a>协议</h2><h3 id="PPP协议"><a href="#PPP协议" class="headerlink" title="PPP协议"></a>PPP协议</h3><h4 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h4><blockquote>
<p><strong>1992</strong> <strong>年制订了</strong> <strong>PPP</strong> <strong>协议。经过</strong> <strong>1993</strong> <strong>年和</strong> <strong>1994</strong> <strong>年的修订，现在的</strong> <strong>PPP</strong> <strong>协议已成为因特网的正式标准**</strong>[RFC 1661][RFC2153]<strong>**。</strong> </p>
</blockquote>
<p><strong>地位</strong></p>
<p>家庭主机到互联网的第一跳链路</p>
<p><strong>组成</strong></p>
<p>一个将 <strong>IP 数据</strong>报封装到<strong>串行链路</strong>的方法。</p>
<p>链路控制协议 LCP (Link Control Protocol)</p>
<ul>
<li>一种扩展链路控制协议，用于建立、配置、测试和管理数据<strong>链路连接</strong>。</li>
</ul>
<p>网络控制协议 NCP (Network Control Protocol)</p>
<ul>
<li>协商该链路上所传输的<strong>数据包</strong>格式与类型，建立、配置不同的网络层协议</li>
</ul>
<h4 id="工作流程"><a href="#工作流程" class="headerlink" title="工作流程"></a>工作流程</h4><p>当用户拨号接入 ISP 时：</p>
<p>（1）路由器的调制解调器<strong>对拨号</strong>做出<strong>确认</strong>，并<strong>建立</strong>一条<strong>物理连接</strong>（底层up）；</p>
<p>（2）<strong>PC</strong> 机向<strong>路由器</strong>发送一系列的 LCP 分组（封装成多个 PPP 帧）；</p>
<p>（3）这些分组及其响应选择一些 PPP 参数，和进行网络层配置（此前如有PAP或CHAP验证先要通过验证），NCP 给新接入的 PC机分配一个临时的 <strong>IP</strong> 地址，使 PC 机成为因特网上的一个主机；</p>
<p>（4）通信完毕时，NCP 释放网络层连接，<strong>收回</strong>原来分配出去的 <strong>IP</strong> 地址。接着，LCP <strong>释放</strong>数据<strong>链路层连接</strong>；</p>
<p>（5）最后<strong>释放物理层</strong>的连接。</p>
<h4 id="协议帧格式"><a href="#协议帧格式" class="headerlink" title="协议帧格式"></a>协议帧格式</h4><p>PPP是面向字节的，因而所有的PPP帧的长度都是整数个字节。</p>
<p><strong>格式</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">标志字段 | 地址字段 | 控制字段 | 协议字段 | &lt;--- 信息字段 ---&gt; | 帧校验字段 | 标志字段</span><br><span class="line">    1         1         1         2        不超过1500字节         2          1</span><br></pre></td></tr></table></figure>

<p>协议字段定义参见RFC1700，它标识出网络层协议数据域的类型。.</p>
<ul>
<li><p>0021：信息字段内容为IP数据报    </p>
</li>
<li><p>C021：信息字段内容为PPP链路控制数据LCP</p>
</li>
<li><p>8021：信息字段内容为网络控制数据NCP</p>
</li>
</ul>
<p>当PPP用在<strong>同步传输链路</strong>时，协议规定采用硬件来完成<strong>比特</strong>填充。</p>
<p>但当PPP用在<strong>异步传输</strong>时，它就使用<strong>字节</strong>填充，转义字符“0x7D”。</p>
<h4 id="认证"><a href="#认证" class="headerlink" title="认证"></a>认证</h4><p>PAP认证方式</p>
<ul>
<li><p>安全性相对<strong>低</strong>，password是<strong>明文</strong>传输，<strong>两次握手</strong></p>
<blockquote>
<p><strong>被叫</strong>提出连接<strong>请求</strong><br><strong>主叫响应</strong></p>
</blockquote>
</li>
</ul>
<p>CHAP认证方式</p>
<ul>
<li><p>安全性相对<strong>高</strong>，hash（哈希值）密码，<strong>三次握手</strong></p>
<blockquote>
<p><strong>主叫</strong>发出<strong>请求</strong></p>
<p><strong>被叫</strong>回复一个<strong>数据包</strong>，这个包里面有主叫发送的随机的哈希值</p>
<p><strong>主叫</strong>在数据库中<strong>确认</strong>无误后发送一个连接成功的数据包连接</p>
</blockquote>
</li>
</ul>
<h2 id="有线LAN技术"><a href="#有线LAN技术" class="headerlink" title="有线LAN技术"></a>有线LAN技术</h2><h3 id="多路访问链路和协议"><a href="#多路访问链路和协议" class="headerlink" title="多路访问链路和协议"></a>多路访问链路和协议</h3><blockquote>
<p>局域网环境，密集端系统通常使用<strong>多路访问</strong>方式</p>
</blockquote>
<h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><p><strong>信道资源紧缺，大量端系统或者频繁访问网络，或者以较小概率访问网络</strong></p>
<h3 id="协议要求"><a href="#协议要求" class="headerlink" title="协议要求"></a>协议要求</h3><ul>
<li><p>共享单一广播信道</p>
</li>
<li><p>两个或更多结点并行传输—&gt;相互干扰<br>  碰撞：如果结点同时接收到两个或更多信号</p>
<p>  多路访问协议</p>
<ul>
<li>该哪个结点发送数据？</li>
<li>发送时会不会出现冲突？</li>
<li>出现冲突怎么办？</li>
</ul>
</li>
</ul>
<p>共享信道的通信必须使用信道本身!<br>不能用带外信道来协调</p>
<h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><p><strong>多路访问MAC协议</strong></p>
<p><strong>协议分类</strong></p>
<p>同一传输介质连接了多个站，而各站都是对等的，这就需要有一种仲裁方式来控制各站使用介质的方式，这就是介质访问控制（MAC）。</p>
<p><strong>信道划分</strong></p>
<blockquote>
<p>静态FDM、TDM(帧长度125微秒)、、WDM、CDMA（<strong>用户数量确定</strong>）</p>
</blockquote>
<ul>
<li>特点：信道在用户通信时固定分配给用户，用户只要得到了信道就不会和别的用户发生冲突；信道利用率低。</li>
<li>改进：动态信道划分STDM</li>
</ul>
<p><strong>动态媒体接入控制</strong>（又称为多路访问(multiple access)）</p>
<blockquote>
<p>信道并非在用户通信时固定分配给用户，<strong>接入数量不确定</strong>。</p>
</blockquote>
<ul>
<li>轮流访问：用户不能随机地发送信息而必须服从一定的控制，如令牌、轮询</li>
<li>随机接入：所有的用户可随机地发送信息：要解决媒体访问冲突的问题，如CSMA/CD</li>
</ul>
<p><strong>协议特点</strong></p>
<p><strong>信道划分MAC协议</strong></p>
<ul>
<li>在高负载时高效、公平地共享信道</li>
<li>低负载时低效：信道访问中延时，当1个活跃结点时，甚至仅有分配了 1/N 带宽! </li>
</ul>
<p><strong>随机访问MAC协议</strong></p>
<ul>
<li>低负载是有效：单个结点能够全面利用信道</li>
<li>高负载：碰撞开销大</li>
</ul>
<p><strong>轮流协议</strong></p>
<ul>
<li>兼有两方面的优点!</li>
</ul>
<p>随机访问协议</p>
<p>引出</p>
<p>大量结点以小概率发送分组</p>
<ul>
<li>以信道全部速率R传输</li>
<li>结点间无优先权协调</li>
</ul>
<p>两个或更多传输结点发送➜ “碰撞”(小概率)<br>随机访问MAC协议定义了: </p>
<ul>
<li>如何检测碰撞</li>
<li>如何从碰撞中恢复 (例如，经延迟后重新传输)</li>
</ul>
<p>实例</p>
<ul>
<li>ALOHA</li>
<li>时隙ALOHA</li>
<li>CSMA, CSMA/CD, CSMA/CA</li>
</ul>
<p><strong>CSMA(载波侦听多路访问)</strong></p>
<blockquote>
<p><strong>发前先听</strong>，听到忙时的等待策略：</p>
</blockquote>
<ul>
<li>非持续CSMA：一旦监听到信道忙，就不再监听；延迟一个随机时间后再次监听。</li>
<li>1-持续CSMA：监听到信道忙时，仍继续监听，直到信道空闲，一听到信道空闲就立即发送数据  。</li>
<li>P-持续CSMA：适用于时隙信道，当听到信道空闲时，以概率p发送数据（以概率1-P延迟到下一时隙再发送）</li>
</ul>
<p><strong>问题</strong></p>
<p><strong>CSMA**</strong>技术不能解决发送过程中出现的冲突现象**</p>
<p><strong>碰撞检测（CSMA/CD）</strong></p>
<p><strong>解决办法</strong></p>
<p>使用带冲突检测的载波监听多点访问CSMA/CD</p>
<p><strong>原理</strong></p>
<ul>
<li><strong>发送前</strong>先监听信道是否空闲，若空闲则立即发送数据。</li>
<li><strong>在发送时</strong>，边发边继续监听。若监听到冲突，则立即停止发送。等待一段随机时间（称为退避）以后，再重新尝试。</li>
</ul>
<p>CSMA/CD可概括为四句话：</p>
<ul>
<li>先听后发 、 边听边发</li>
<li>冲突即停、 延迟重发</li>
</ul>
<h3 id="策略"><a href="#策略" class="headerlink" title="策略"></a>策略</h3><p><strong>争用期</strong></p>
<p>显然，在使用CSMA/CD协议时，一个站不可能同时既发送又接收。因此使用CSMA/CD协议的以太网不可能进行全双工通信而只能进行双向交替通信(半双工通信)。</p>
<p>每一个站在自己发送数据之后的一小段时间内，存在着遭遇碰撞的可能性。这一特点称为<strong>以太网发送的不确定性</strong>。<br>发送数据帧期间，刚刚开始的一段时间是危险期。</p>
<p><strong>概念</strong></p>
<p>总线上<strong>最晚</strong>可以检测到冲突的时间为2τ，因此将此时间定义为以太网信道的争用期(contention period) ，又称为碰撞窗口(collision window) </p>
<p><strong>最小帧长</strong></p>
<p>区分正常数据和碰撞的碎片</p>
<ul>
<li>10M的以太网争用期取51.2μs，经过争用期的考验才能肯定数据发送是否成功。</li>
</ul>
<p>解决办法</p>
<ul>
<li>定义最短有效帧长 2τ×R, 51.2μs * 10M/s = 512bit = 64B</li>
</ul>
<p><strong>冲突即停</strong></p>
<p>当发送数据的站一旦发现发生了碰撞时：</p>
<ul>
<li>立即停止发送数据；</li>
<li>再继续发送若干比特的人为干扰信号(jamming signal)，以便让所有用户都知道现在已经发生了碰撞。</li>
</ul>
<blockquote>
<p>强化冲突信号: 确保所有的其他传输方都知道碰撞; 48 bit长</p>
</blockquote>
<p><strong>延时重发</strong></p>
<p>TBEB： Truncated Binary Exponential Backoff,<strong>截断二进制指数退避算法</strong></p>
<p>目标：估计当前负载，适应重传尝试</p>
<p>重负载: 随机等待时间更长</p>
<ol>
<li>确定基本退避时间，T0=2τ,最大冲突次数N；</li>
<li>定义参数n，记录连续冲突次数；</li>
<li>令k=Min[n，10]，从整数集合[0,1,2，…，(2k-1)]中随机取出一个数r，等待的时延为T=r* T0 ;</li>
<li>当冲突次数n超过16次后，发送失败，丢弃传输的帧，发送错误报告。</li>
</ol>
<h3 id="效率"><a href="#效率" class="headerlink" title="效率"></a>效率</h3><blockquote>
<ul>
<li>τ = 总线中最远2站点之间的传播时延</li>
<li>T0 =单帧最长发送时延</li>
<li>随着τ趋于0, 效率趋于1，可能吗？</li>
<li>随着T0趋于无穷大，效率趋于1</li>
</ul>
</blockquote>
<p>有碰撞多节点：E = 1 / (1 + 4.44𝜏 / T0)</p>
<p>无碰撞单节点：E =  1 / (1 + 𝜏 / T0)</p>
<h2 id="以太网"><a href="#以太网" class="headerlink" title="以太网"></a>以太网</h2><p>•100Mbs网卡低于$10!</p>
<p>•率先广泛使用的LAN技术</p>
<p>•比令牌LAN和ATM等更简单、便宜</p>
<p>•在速率竞赛中取胜: 10 Mbps ~ 10 Gbps </p>
<p><strong>拓扑</strong>: 总线到星型</p>
<p>直到20世纪90年代，总线拓扑流行</p>
<blockquote>
<p>目前星型拓扑流行，可靠性提高</p>
</blockquote>
<ul>
<li>中心为有源交换机（区分Hub和交换机结构）</li>
<li>每段单独运行以太网协议，此时结点相互没有碰撞(?)</li>
</ul>
<h3 id="MAC地址"><a href="#MAC地址" class="headerlink" title="MAC地址"></a>MAC地址</h3><blockquote>
<p>在局域网中，硬件地址又称为物理地址，或 MAC 地址。<br>IEEE802 标准所说的“地址”严格地讲应当是每一个站的“名字”或标识符。 一个48bit的全局地址，与其物理位置无关。</p>
</blockquote>
<h3 id="MAC结构"><a href="#MAC结构" class="headerlink" title="MAC结构"></a>MAC结构</h3><blockquote>
<p>IEEE的注册管理委员会RAC (Registration Authority Committee)是局域网全球地址的法定管理机构，它负责分配地址字段的六个字节中的前三个字节(即高位24 bit)。<br>世界上凡要生产局域网网卡的厂家都必须购买前三个字节构成的一个号(即地址块)，即机构惟一标识符OUI (Organizationally Unique Identifier)，通常也叫做公司标识符(company_id)。<br>地址字段中的后三个字节(即低位24 bit)由厂家自行指派，称为扩展标识符(extended identifier)，只要保证生产出的网卡没有重复地址即可。</p>
</blockquote>
<p><strong>两种形式</strong>：6B 全球范围 / 2B 单位范围</p>
<p>Ethernet地址 = Manufacture ID + NIC ID<br>                                            24bit         24bit<br>   公司：Cisco    00-00-0c<br>              Novell   00-00-1B<br>                            00-00-D8<br>              3Com    00-20-AF<br>                            00-60-8C<br>               IBM     08-00-5A</p>
<p>适配器的MAC地址具有扁平(没有层次)结构，且保持不变</p>
<p>地址类型标识：地址字段的第一字节的最低位I/G<br>    0 – 单个站地址<br>    1 – 组地址</p>
<p>地址范围标识：地址字段的第一字节的最低第二位U/L<br>     0 – 局部管理<br>     1 – 全局管理</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5CANGLE0%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200510172436165.png"  alt="image-20200510172436165"></p>
<p>PA : 前同步码 -  10101010序列，用于使接收方与发送方同步<br>SFD : 帧首定界 – 10101011<br>DA: 目的地址 – MAC 地址<br>SA: 源地址 – MAC地址<br>LEN:数据长度（数据部分的字节数）（0-1500）（802.3 frame）<br>Type: 高层协议类型标识(≥1536） （ Ethernet V2 和 802.3 frame）<br>pad 填充字段，保证帧长不少于64字节<br>FCS : 帧校验序列（ CRC-32 ）</p>
<h3 id="不可靠，无连接的服务"><a href="#不可靠，无连接的服务" class="headerlink" title="不可靠，无连接的服务"></a>不可靠，无连接的服务</h3><ul>
<li>无连接: 在发送和接收适配器之间没有握手</li>
<li>不可靠: 接收适配器不向发送适配器发送应答或否定应答</li>
</ul>
<blockquote>
<p>传送给网络层的数据报流可能有丢包如果应用程序使用TCP，将能弥补丢包否则，应用程序将发现丢包</p>
</blockquote>
<p>以太网的MAC协议：无时隙的CSMA/CD</p>
<h3 id="无效MAC帧"><a href="#无效MAC帧" class="headerlink" title="无效MAC帧"></a>无效MAC帧</h3><p>数据字段的长度与长度字段的值不一致；<br>帧的长度不是整数个字节；<br>用收到的帧检验序列 FCS 查出有差错；<br>数据字段的长度不在 46 ~ 1500 字节之间。<br>有效的 MAC 帧长度为 64 ~ 1518 字节之间。<br>对于检查出的无效 MAC 帧就简单地丢弃。以太网不负责重传丢弃的帧。 </p>
<h2 id="物理"><a href="#物理" class="headerlink" title="物理"></a>物理</h2><h3 id="集线器"><a href="#集线器" class="headerlink" title="集线器"></a>集线器</h3><blockquote>
<p>物理层“哑”中继器 :</p>
</blockquote>
<ul>
<li>来自一条链路的比特从其他所有链路出去</li>
<li>与集线器连接的所有结点相互碰撞</li>
<li>无帧缓存</li>
<li>集线器无CSMA/CD : 适配器检测碰撞</li>
</ul>
<h3 id="交换机"><a href="#交换机" class="headerlink" title="交换机"></a>交换机</h3><blockquote>
<p>链路层设备：比集线器智能化</p>
</blockquote>
<p>存储并转发以太网帧（基于查表的转发和流量过滤）</p>
<ul>
<li>当帧在网段上转发时，检查帧首部并基于MAC目的地址，选择性地向一个或多个出链路转发帧</li>
<li>当帧在网段上转发时，使用CSMA/CD 访问网段</li>
</ul>
<p>即插即用, 自学习（基于自学习的转发表的构建）</p>
<ul>
<li>交换机不必配置</li>
</ul>
<p>透明性</p>
<ul>
<li>主机不知道交换机的存在</li>
</ul>
<h3 id="网桥，以太网交换机"><a href="#网桥，以太网交换机" class="headerlink" title="网桥，以太网交换机"></a>网桥，以太网交换机</h3><ol>
<li>接收帧</li>
<li>缓存</li>
<li>分析，查表</li>
<li>丢弃发往同LAN的帧；否则转发到相应端口</li>
</ol>
<h3 id="交换机工作方式"><a href="#交换机工作方式" class="headerlink" title="交换机工作方式"></a>交换机工作方式</h3><p>工作原理归纳为：丢弃同网帧，转发异网帧，广播未知帧，学习源地址</p>
<h3 id="帧转发过程"><a href="#帧转发过程" class="headerlink" title="帧转发过程"></a>帧转发过程</h3><ul>
<li>网桥的X端口收到一个来自站A去往站B的帧，则用帧目的地址B查询转发表中对应的端口<ul>
<li>若目的端口与源端口X相同，则丢弃该帧；</li>
<li>目的端口与源端口X不同，则转发该帧；</li>
<li>目的端口未知，则向来<strong>源X端口之外</strong>各端口<strong>广播</strong>该帧，并通过逆向学习<strong>更新</strong>转发表。</li>
</ul>
</li>
</ul>
<p><strong>转发表的建立</strong></p>
<p>在转发过程中逆向学习，若<strong>帧的源地址</strong>A不在表中，则将该地址A及来源端口X对应插入到表中。</p>
<h3 id="数据交换"><a href="#数据交换" class="headerlink" title="数据交换"></a>数据交换</h3><p>在源和目的端口的数据交换：</p>
<p>存储转发方式－store &amp; forward：收完整个数据帧，并在CRC校验通过之后，才能进行转发操作。</p>
<ul>
<li>优点：有容错机制</li>
<li>缺点：延迟大小受帧长控制</li>
</ul>
<p>直通方式－cut through：在接收数据帧时，一旦检测到目的地址就立即进行转发操作。</p>
<ul>
<li>优点：转发不受帧长限制，低延迟</li>
<li>缺点：无校验，出错后浪费带宽</li>
</ul>
<p>自由分段－Fragment-free：一旦检测到该数据帧不是冲突碎片，就进行转发操作。</p>
<ul>
<li>优点：延迟介于1、2间</li>
<li>缺点：无校验，但出错几率低</li>
</ul>
<h3 id="链路层交换机特点"><a href="#链路层交换机特点" class="headerlink" title="链路层交换机特点"></a>链路层交换机特点</h3><ol>
<li>无碰撞：每个接口是独立的碰撞域，各个接口之间互相不会冲突（非广播帧）</li>
<li>异质的链路：各个接口可以具有不同的链路类型（不同的速率、介质、帧结构）</li>
<li>便于管理</li>
<li>更安全：流量隔离，不能嗅探</li>
<li>不能隔离广播流量：所有端口存在于1个广播域</li>
</ol>
<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>Host X发送的帧导致以下问题：<br>广播风暴（图１）<br>多帧复制（图２）<br>转发表不稳定（图３）</p>
<p><strong>解决方法</strong></p>
<p>解决方法——生成树STP(Spanning Tree Protocol)</p>
<p>​    利用图论的原理，让网桥之间互相通信，用一棵连接每个LAN的生成树（Spanning Tree）覆盖实际的拓扑结构,形成一个无回路的网络。</p>
<p>交换机运行STP的过程</p>
<ol>
<li>检测并发现环路的存在（每隔2s广播BPDU）；</li>
<li>将冗余链路的1条设为主链路，其余均为备用；</li>
<li>通过阻塞某些备用链路来破环为树；</li>
<li>只通过主链路交换流量；</li>
<li>定期检查链路的情况，主链路出故障则启用备用链路。</li>
</ol>
<h2 id="虚拟局域网"><a href="#虚拟局域网" class="headerlink" title="虚拟局域网"></a>虚拟局域网</h2><blockquote>
<p>VLAN（Virtual Local Area Network）即虚拟局域网，是一种通过将局域网内的设备逻辑地而不是物理地划分成一个个网段从而实现虚拟工作组的新兴技术。</p>
<p>IEEE于1999年颁布了用以标准化VLAN实现方案的802.1Q协议标准草案。</p>
</blockquote>
<p>VLAN技术允许网络管理者将一个物理的LAN逻辑地划分成不同的广播域（或称虚拟LAN，即VLAN），每一个VLAN都包含一组有着相同需求的计算机工作站，与物理上形成的LAN有着相同的属性。</p>
<p>一个VLAN内部的广播和单播流量都不会转发到其他VLAN中，从而有助于控制流量、减少设备投资、简化网络管理、提高网络的安全性。 </p>
<h3 id="以太帧格式"><a href="#以太帧格式" class="headerlink" title="以太帧格式"></a>以太帧格式</h3><p>虚拟局域网协议允许在以太网的帧格式中插入一个 4 字节的标识符，称为 VLAN 标记(tag)，用来指明发送该帧的工作站属于哪一个虚拟局域网。 </p>
<h3 id="构建技术"><a href="#构建技术" class="headerlink" title="构建技术"></a>构建技术</h3><ol>
<li>基于端口的VLAN（最常用）</li>
<li>基于MAC地址的VLAN（基于用户）</li>
<li>基于协议的VLAN</li>
<li>基于网络层地址的VLAN</li>
</ol>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Alex</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://herycs.github.io/2020/03/25/network-a-directNet/">https://herycs.github.io/2020/03/25/network-a-directNet/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/network/">network</a></div><div class="post_share"><div class="social-share" data-image="/img/post.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/05/20/network-a-interconnection/"><img class="prev_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">network-a-interconnection.md</div></div></a></div><div class="next-post pull_right"><a href="/2020/03/15/network-a-communication/"><img class="next_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">network-a-communication.md</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> Recommend</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/03/15/network-a-communication/" title="network-a-communication.md"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-15</div><div class="relatedPosts_title">network-a-communication.md</div></div></a></div><div class="relatedPosts_item"><a href="/2019/07/21/network-a-http/" title="network-a-http"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-07-21</div><div class="relatedPosts_title">network-a-http</div></div></a></div><div class="relatedPosts_item"><a href="/2019/08/15/network-a-https/" title="network-a-https"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-08-15</div><div class="relatedPosts_title">network-a-https</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/10/network-a-summary/" title="network-a-summary.md"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-10</div><div class="relatedPosts_title">network-a-summary.md</div></div></a></div><div class="relatedPosts_item"><a href="/2020/05/20/network-a-interconnection/" title="network-a-interconnection.md"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-05-20</div><div class="relatedPosts_title">network-a-interconnection.md</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By Alex</div><div class="framework-info"><span>Driven </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="Traditional Chinese and Simplified Chinese Conversion" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>